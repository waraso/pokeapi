<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PokeAPI</title>
    <style>
        #pokemonImage {
            position: relative;
            top: 160px;
            transform: scale(6) rotate(0deg);
            image-rendering: pixelated;
        }
    </style>
</head>
<body>
    <div style="text-align: center; margin-top: 50px; margin: 0 auto;">
        <input type="text" id="pokemonId" placeholder="ポケモンの図鑑番号か英名を入力" value="1">
        <button id="fetchButton">ゲット！</button>
        <button id="favoriteButton">お気に入り</button>
        <br>
        <p>お気に入り: <span id="favoritesList"></span></p>
        <div id="pokemonData">
            <img id="pokemonImage">
        </div>
    </div>
    
    <script>
        let r = 0;
        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('fetchButton').click();
        })
        document.getElementById('fetchButton').addEventListener('click', async () => {
            const pokemonId = document.getElementById('pokemonId').value;
            if (!pokemonId) return;

            const response = await fetch(`https://pokeapi.co/api/v2/pokemon/${pokemonId}`);
            const data = await response.json();

            const pokemonDataDiv = document.getElementById('pokemonData');
            pokemonDataDiv.innerHTML = `
                <h2>${data.name}</h2>
                    <img id="pokemonImage" src="${data.sprites.front_default}" style="">
                `;
            document.getElementById('pokemonImage').addEventListener('click', (e) => {
                r = (r + 90) % 360;
                e.currentTarget.style.transform = `scale(6) rotate(${r}deg)`;
            });
        });
        document.getElementById('favoriteButton').addEventListener('click', () => {
            const pokemonId = document.getElementById('pokemonId').value;
            if (!pokemonId) return;
            const favorites = JSON.parse(localStorage.getItem('favorites')) || [];
            if (!favorites.includes(pokemonId)) {
                favorites.push(pokemonId);
                localStorage.setItem('favorites', JSON.stringify(favorites));
                alert(`ポケモンID ${pokemonId} をお気に入りに追加しました！`);
            } else {
                alert(`ポケモンID ${pokemonId} はすでにお気に入りに追加されています。`);
            }
        });
        document.getElementById('loadButton').addEventListener('click', () => {
            const favorites = JSON.parse(localStorage.getItem('favorites')) || [];
            const favoritesList = document.getElementById('favoritesList');
            favoritesList.innerHTML = favorites.length > 0 ? favorites.join(', ') : 'お気に入りはありません。';
        });
    </script>
</body>
</html>